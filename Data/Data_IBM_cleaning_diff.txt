DataFull_2008103_10_IBM:

#RIC,DateTime,Time,Price,Bid Price,Ask Price,Volume,Duration,TimeInSec,TickReturn,LogReturn
IBM.N,2008-10-03 09:30:05.041,09:30:05.041000,105.25,105.12,105.25,200,0.060000,5.041000,0,0.0
IBM.N,2008-10-03 09:30:05.131,09:30:05.131000,105.25,105.13,105.39,300,0.090000,5.131000,0,0.0
IBM.N,2008-10-03 09:30:05.373,09:30:05.373000,105.39,105.25,105.44,100,0.242000,5.373000,14,0.001329282383354169
IBM.N,2008-10-03 09:30:05.521,09:30:05.521000,105.44,105.25,105.46,100,0.148000,5.521000,5,0.0004743158083515553
IBM.N,2008-10-03 09:30:05.671,09:30:05.671000,105.46,105.25,105.5,100,0.150000,5.671000,2,0.00018966334812642316
IBM.N,2008-10-03 09:30:05.881,09:30:05.881000,105.50,105.25,105.5,100,0.210000,5.881000,4,0.0003792188137978769
IBM.N,2008-10-03 09:30:06.091,09:30:06.091000,105.50,105.25,105.5,200,0.210000,6.091000,0,0.0
IBM.N,2008-10-03 09:30:06.151,09:30:06.151000,105.58,105.25,105.53,400,0.060000,6.151000,8,0.0007580064793488717
IBM.N,2008-10-03 09:30:06.931,09:30:06.931000,105.59,105.15,105.59,100,0.780000,6.931000,1,9.471042295317034e-05
IBM.N,2008-10-03 09:30:08.011,09:30:08.011000,105.54,105.15,105.59,100,1.080000,8.011000,-5,-0.00047364184090170625
IBM.N,2008-10-03 09:30:09.451,09:30:09.451000,105.50,105.14,105.5,100,1.440000,9.451000,-4,-0.00037907506140033576
IBM.N,2008-10-03 09:30:10.321,09:30:10.321000,105.59,105.14,105.59,100,0.870000,10.321000,9,0.000852716902302042
IBM.N,2008-10-03 09:30:10.861,09:30:10.861000,105.52,105.14,105.52,100,0.540000,10.861000,-7,-0.0006631614093643989
IBM.N,2008-10-03 09:30:11.161,09:30:11.161000,105.59,105.14,105.66,100,0.300000,11.161000,7,0.0006631614093643989
IBM.N,2008-10-03 09:30:11.221,09:30:11.221000,105.66,105.14,105.66,100,0.060000,11.221000,7,0.0006627219177461896
IBM.N,2008-10-03 09:30:11.611,09:30:11.611000,105.60,105.59,105.66,200,0.390000,11.611000,-6,-0.0005680204640086117
IBM.N,2008-10-03 09:30:11.911,09:30:11.911000,105.75,105.59,105.75,600,0.300000,11.911000,15,0.0014194466542267747
IBM.N,2008-10-03 09:30:12.331,09:30:12.331000,105.70,105.48,105.75,200,0.420000,12.331000,-5,-0.0004729250501958049
IBM.N,2008-10-03 09:30:12.391,09:30:12.391000,105.75,105.48,105.75,500,0.060000,12.391000,5,0.0004729250501958049
IBM.N,2008-10-03 09:30:12.961,09:30:12.961000,105.75,105.3,105.75,400,0.570000,12.961000,0,0.0


Data_2008103_10_IBM:

5.041000,0,105.25,0.0
5.131000,0,105.25,0.0
5.373000,14,105.39,0.001329282383354169
5.521000,5,105.44,0.0004743158083515553
5.671000,2,105.46,0.00018966334812642316
5.881000,4,105.50,0.0003792188137978769
6.091000,0,105.50,0.0
6.151000,8,105.58,0.0007580064793488717
6.931000,1,105.59,9.471042295317034e-05
8.011000,-5,105.54,-0.00047364184090170625
9.451000,-4,105.50,-0.00037907506140033576
10.321000,9,105.59,0.000852716902302042
10.861000,-7,105.52,-0.0006631614093643989
11.161000,7,105.59,0.0006631614093643989
11.221000,7,105.66,0.0006627219177461896
11.611000,-6,105.60,-0.0005680204640086117
11.911000,15,105.75,0.0014194466542267747
12.331000,-5,105.70,-0.0004729250501958049
12.391000,5,105.75,0.0004729250501958049
12.961000,0,105.75,0.0


        trades=trades[['#RIC' , 'DateTime', 'Time',  'Price', 'Bid Price','Ask Price','Volume']]
        
        trades['Duration']=trades['Time'].map(time_in_sec).diff()
        trades['TimeInSec']=trades['Time'].map(time_in_sec_from_start)
        #Calculating tick returns
        trades['TickReturn']=(trades['Price']/0.01).diff()   
        trades['LogReturn']=(np.log(trades['Price'])).diff() 
        trades=trades[trades['Duration'] >=0 ]  
        nums.append(len(trades.index))             
        print 'Number of trades in without opening trades: '+str(len(trades.index))        
        
        #Float formatting 
        trades['TickReturn']= trades['TickReturn'].apply(lambda x: '%d' % x)    
        trades['Volume']= trades['Volume'].apply(lambda x: '%d' % x)
        trades['Price']= trades['Price'].apply(lambda x: '%.2f' % x)
        trades['Duration']= trades['Duration'].apply(lambda x: '%.6f' % x)
        trades['TimeInSec']= trades['TimeInSec'].apply(lambda x: '%.6f' % x)
        
        
                     
        print 'Befor writing out: '+str(len(trades.index))
       
        
        trades.to_csv('DataFull_'+f[5:11]+str(Days[0])+'_'+str(Days[len(Days)-1])+'_'+tick.rstrip('.N')+'.csv',index=False)
       
        tradesIn=trades[trades['DateTime'].map(get_day).isin(DaysIn)]
        tradesIn=tradesIn[['TimeInSec', 'TickReturn','Price','LogReturn']]
        tradesIn.to_csv('Data_'+f[5:11]+str(DaysIn[0])+'_'+str(DaysIn[len(DaysIn)-1])+'_'+tick.rstrip('.N')+'.csv' ,index=False,header=False)
        